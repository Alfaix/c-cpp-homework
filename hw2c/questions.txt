1. Правильно понимаю, что token_t занимает лишнее место? что в таких случаях делать, писать 3 разных массива под каждый тип?
2. В логических И/ИЛИ, если первый аргумент соответственно ложь/истина, второй не выполняется? Если так, что происходит в случаях, если у второго аргумента есть side effects?
3. Вообще, вот такой вариант написания кода, где после каждого вызова функции надо что-то проверить - это норма в C или я что-то делаю не так?